@model Dtos.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
    Layout = "_AdminLayout";
}

<style>
  :root {
    --col-hash: 140px;  /* largura fixa para o Hash */
    --col-valor: 90px;  /* largura fixa para Valor */
    --col-data: 110px;  /* largura fixa para Data */
  }

  /* Evita que qualquer container gere barra horizontal */
  .table-responsive { 
    overflow-x: hidden; 
  }

  /* Tabela responsiva sem estourar a largura */
  table.table-transactions {
    width: 100%;
    table-layout: fixed;          /* divide o espaço de forma fixa */
    border-collapse: collapse;
  }

  table.table-transactions col.hash  { width: 140px; }
  table.table-transactions col.valor { width: 90px; }
  table.table-transactions col.data  { width: 110px; }

  /* Trunca conteúdo longo com reticências, mas mostra completo no title */
  .clamp {
    display: inline-block;
    max-width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Caso queira permitir quebra de linha para textos muito longos */
  .break-anywhere {
    overflow-wrap: anywhere;
    word-break: break-word;
  }
</style>

<div class="row">
    <!-- Balance Card -->
    <div class="col-lg-3 col-6">
        <div class="small-box bg-info">
            <div class="inner">
                <h3>@Model.Balance.ToString("F2") Dtc</h3>
                <p>Saldo em Carteira</p>
            </div>
            <div class="icon">
                <i class="fas fa-wallet"></i>
            </div>
            <a asp-action="Wallet" class="small-box-footer">Gerenciar <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- Staked Card -->
    <div class="col-lg-3 col-6">
        <div class="small-box bg-success">
            <div class="inner">
                <h3>@Model.StakedAmount.ToString("F2") Dtc</h3>
                <p>Total em Staking (Rendendo)</p>
            </div>
            <div class="icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <a asp-action="Wallet" class="small-box-footer">Ver Detalhes <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
    <!-- Contracts Card -->
    <div class="col-lg-3 col-6">
        <div class="small-box bg-danger">
            <div class="inner">
                <h3>@Model.TotalContracts</h3>
                <p>Contratos Inteligentes</p>
            </div>
            <div class="icon">
                <i class="fas fa-file-contract"></i>
            </div>
            <a asp-action="Contracts" class="small-box-footer">Administrar <i class="fas fa-arrow-circle-right"></i></a>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header border-transparent">
                <h3 class="card-title">Últimas Transações</h3>
            </div>

            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table m-0 table-transactions">
                        <colgroup>
                            <col class="hash" />
                            <col />
                            <col />
                            <col class="valor" />
                            <col class="data" />
                        </colgroup>

                        <thead>
                            <tr>
                                <th>Hash ID</th>
                                <th>De</th>
                                <th>Para</th>
                                <th>Valor</th>
                                <th>Data</th>
                            </tr>
                        </thead>

                        <tbody>
                            @foreach (var t in Model.RecentTransactions)
                            {
                                <tr>
                                    <!-- Hash curto na célula, valor completo no title -->
                                    <td>
                                        <a href="#" title="@t.hash">@t.hash?.Substring(0, 8)…</a>
                                    </td>

                                    <!-- Campos longos com reticências -->
                                    <td>
                                        <span class="clamp" title="@t.fromAddress">@t.fromAddress</span>
                                    </td>

                                    <td>
                                        <span class="clamp" title="@t.toAddress">@t.toAddress</span>
                                    </td>

                                    <td>
                                        <span class="clamp" title="@t.amount">@t.amount Dtc</span>
                                    </td>

                                    <td>
                                        <span class="clamp" title='@t.timestamp.ToString("u")'>@t.timestamp.ToShortDateString()</span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
